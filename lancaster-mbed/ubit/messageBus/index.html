<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Doãn Minh Đăng">
  
  <title>messageBus - Microbit Việt Nam</title>
  

  <link rel="shortcut icon" href="../../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">
  <link href="../../../lancaster-mbed/resources/bluetooth/style.css" rel="stylesheet">

  <link rel="stylesheet" href="../../../css/custom.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "messageBus";
    var mkdocs_page_input_path = "lancaster-mbed/ubit/messageBus.md";
    var mkdocs_page_url = "/lancaster-mbed/ubit/messageBus/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script>
  <script src="../../../js/theme.js"></script>
  <script src="../../../js/jquery.cookie-1.4.1.min.js"></script>
  <script src="../../../js/nav.js"></script> 
  <script src="../../../lancaster-mbed/resources/bluetooth/functions.js"></script>

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-60470603-6', 'help.microbit.vn');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Microbit Việt Nam</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../.." id="Trang chủ" style="font-size:95%;font-weight:bold;">Trang chủ</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="current">
        <a class="current"  id="Nội dung" style="font-size:95%;font-weight:bold;">Nội dung</a>
    </li>
    
        <li class="current">
            <a style="padding-left:50px;" class="current"  id="Microbit - Mbed - C/C++" onclick="showChildren('Microbit - Mbed - C/C++')">Microbit - Mbed - C/C++  <i class="fa fa-arrow-circle-down" style="padding-left:5px;font-size:13px;"></i></a>
        </li>
        
        <div style="display:none" id="hidden_Microbit - Mbed - C/C++">
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="General" onclick="showChildren('Microbit - Mbed - C/C++General')">General  <i class="fa fa-arrow-circle-down" style="padding-left:5px;font-size:13px;"></i></a>
            </li>
            
            <div style="display:none" id="hidden_Microbit - Mbed - C/C++General">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../" id="Introduction">Introduction </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../concepts/" id="Concepts">Concepts </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../advanced/" id="Advanced">Advanced </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../online-toolchains/" id="Web-based Development">Web-based Development </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../offline-toolchains/" id="Offline Development">Offline Development </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../device/" id="Hardware">Hardware </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../help/" id="Help">Help </a>
                </li>
            
            </div>
        
            <li class="current">
                <a style="padding-left:70px;" class="current"  id="uBit" onclick="showChildren('Microbit - Mbed - C/C++GeneraluBit')">uBit  <i class="fa fa-arrow-circle-down" style="padding-left:5px;font-size:13px;"></i></a>
            </li>
            
            <div style="display:none" id="hidden_Microbit - Mbed - C/C++GeneraluBit">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../" id="Overview">Overview </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../i2c/" id="i2c">i2c </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../storage/" id="storage">storage </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../serial/" id="serial">serial </a>
                </li>
            
                <li class="current">
                    <a style="padding-left:90px;" class="current" href="./" id="messageBus">messageBus </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../button/" id="buttons">buttons </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../display/" id="display">display </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../accelerometer/" id="accelerometer">accelerometer </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../compass/" id="compass">compass </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../thermometer/" id="thermometer">thermometer </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../io/" id="io">io </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../radio/" id="radio">radio </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Data Types" onclick="showChildren('Microbit - Mbed - C/C++GeneraluBitData Types')">Data Types  <i class="fa fa-arrow-circle-down" style="padding-left:5px;font-size:13px;"></i></a>
            </li>
            
            <div style="display:none" id="hidden_Microbit - Mbed - C/C++GeneraluBitData Types">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../data-types/image/" id="MicroBitImage">MicroBitImage </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../data-types/event/" id="MicroBitEvent">MicroBitEvent </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../data-types/string/" id="ManagedString">ManagedString </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../data-types/packetbuffer/" id="PacketBuffer">PacketBuffer </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Bluetooth" onclick="showChildren('Microbit - Mbed - C/C++GeneraluBitData TypesBluetooth')">Bluetooth  <i class="fa fa-arrow-circle-down" style="padding-left:5px;font-size:13px;"></i></a>
            </li>
            
            <div style="display:none" id="hidden_Microbit - Mbed - C/C++GeneraluBitData TypesBluetooth">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../ble/profile/" id="Profile">Profile </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../ble/accelerometer-service/" id="AccelerometerService">AccelerometerService </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../ble/button-service/" id="ButtonService">ButtonService </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../ble/dfu-service/" id="DFUService">DFUService </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../ble/event-service/" id="EventService">EventService </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../ble/iopin-service/" id="IOPinService">IOPinService </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../ble/led-service/" id="LEDService">LEDService </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../ble/magnetometer-service/" id="MagnetometerService">MagnetometerService </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../ble/temperature-service/" id="TemperatureService">TemperatureService </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../ble/uart-service/" id="UARTService">UARTService </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../ble/ble-connection-events/" id="Connection Events">Connection Events </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Extras" onclick="showChildren('Microbit - Mbed - C/C++GeneraluBitData TypesBluetoothExtras')">Extras  <i class="fa fa-arrow-circle-down" style="padding-left:5px;font-size:13px;"></i></a>
            </li>
            
            <div style="display:none" id="hidden_Microbit - Mbed - C/C++GeneraluBitData TypesBluetoothExtras">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../extras/light-sensing/" id="MicroBitLightSensor">MicroBitLightSensor </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../extras/spi/" id="SPI">SPI </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../blemanager/" id="_blemanager">_blemanager </a>
            </li>
            
            <div style="display:none" id="hidden_Microbit - Mbed - C/C++GeneraluBitData TypesBluetoothExtras_blemanager">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../multibutton/" id="_buttonAB">_buttonAB </a>
            </li>
            
            <div style="display:none" id="hidden_Microbit - Mbed - C/C++GeneraluBitData TypesBluetoothExtras_blemanager_buttonAB">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../radioevent/" id="_radioevent">_radioevent </a>
            </li>
            
            <div style="display:none" id="hidden_Microbit - Mbed - C/C++GeneraluBitData TypesBluetoothExtras_blemanager_buttonAB_radioevent">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../radiodatagram/" id="_radiodatagram">_radiodatagram </a>
            </li>
            
            <div style="display:none" id="hidden_Microbit - Mbed - C/C++GeneraluBitData TypesBluetoothExtras_blemanager_buttonAB_radioevent_radiodatagram">
            
            </div>
        
        </div>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../../projects/projects/" id="Các dự án" style="font-size:95%;font-weight:bold;">Các dự án</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../../license/" id="Bản quyền" style="font-size:95%;font-weight:bold;">Bản quyền</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../../contributor/" id="Đóng góp" style="font-size:95%;font-weight:bold;">Đóng góp</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Microbit Việt Nam</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Microbit - Mbed - C/C++ &raquo;</li>
        
      
        
          <li>uBit &raquo;</li>
        
      
    
    <li>messageBus</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/microbitvn/help.microbit.vn" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="ubitmessagebus">uBit.messageBus<a class="headerlink" href="#ubitmessagebus" title="Permanent link">#</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">#</a></h2>
<p>The micro:bit has an eventing model that can notify user code when specific things happen on the micro:bit.</p>
<p>For example, the <a href="../accelerometer/"><code>MicroBitAccelerometer</code></a> will raise events to indicate that the
micro:bit has be been shaken, or is in freefall. <a href="../button/"><code>MicroBitButton</code></a> will send events on a range of button up, down, click and hold events.</p>
<p>Programmers are also free (in fact, encouraged!) to send their own events whenever they feel it would be useful.</p>
<h2 id="registering-an-event-handler">Registering an event handler<a class="headerlink" href="#registering-an-event-handler" title="Permanent link">#</a></h2>
<p>The <code>MicroBitMessageBus</code> records which events your program is interested in, and delivers those <code>MicroBitEvent</code>s to your program as they occur
through a defined <strong>event handler</strong>.  </p>
<p>This is achieved through the <code>MicroBitMessageBus</code> <code>listen</code> function. This lets you attach a callback
to a function when a specified event (or events) occur.</p>
<p>You can also control the queuing and threading model used for your callback function on a per event handler basis.</p>
<p>This may sound complex at first, but it is actually very simple. For example, to find out when button A is clicked, write some code like this:</p>
<pre class="code"><code class="language-cpp">#include &quot;MicroBit.h&quot;

MicroBit    uBit;

void onButtonA(MicroBitEvent)
{
    uBit.display.print(&quot;A&quot;);
}

int main()
{
    uBit.init();
    uBit.messageBus.listen(MICROBIT_ID_BUTTON_A, MICROBIT_BUTTON_EVT_CLICK, onButtonA);

    // We don't want to drop out of main!
    while(1)
        uBit.sleep(100);
}</code></pre>


<p>Now, whenever the <code>MICROBIT_BUTTON_EVT_CLICK</code> event is raise by <code>MICROBIT_ID_BUTTON_A</code>, your code inside function <code>onButtonA</code> will be automatically run.</p>
<p>You can call listen as many times as you want to attached functions to each of the events that are useful for your program.</p>
<h2 id="wildcard-events">Wildcard Events<a class="headerlink" href="#wildcard-events" title="Permanent link">#</a></h2>
<p>Sometimes though, you want to capture all events generated by some component. For example, you might want to know when any changes in a button has happened.</p>
<p>In this case, there is a special event value called <code>MICROBIT_EVT_ANY</code>. If you call listen with this value, then ALL events from the given source component will be delivered to your function.</p>
<p>You can find out which ones by looking at the <code>MicroBitEvent</code> delivered to your function - it contains the source and value variable of the event.</p>
<p>For example, you could write a program like this:</p>
<pre class="code"><code class="language-cpp">#include &quot;MicroBit.h&quot;

MicroBit    uBit;

void onButtonA(MicroBitEvent e)
{
    if (e.value == MICROBIT_BUTTON_EVT_CLICK)
        uBit.display.scroll(&quot;CLICK&quot;);

    if (e.value == MICROBIT_BUTTON_EVT_DOWN)
        uBit.display.scroll(&quot;DOWN&quot;);
}

int main()
{
    uBit.init();
    uBit.messageBus.listen(MICROBIT_ID_BUTTON_A, MICROBIT_EVT_ANY, onButtonA);

    // We don't want to drop out of main!
    while(1)
        uBit.sleep(100);
}</code></pre>


<p>If you <em>REALLY</em> want even more events, there is also a <code>MICROBIT_ID_ANY</code> source, that allows you to attach a function to event generated from any component.</p>
<p>Use this sparingly though, as this could be quite a lot of events!</p>
<p>The following code would attach the <code>onEvent</code> function to receive all the events from the whole runtime:</p>
<pre class="code"><code class="language-cpp">#include &quot;MicroBit.h&quot;

MicroBit    uBit;

void onEvent(MicroBitEvent)
{
    uBit.display.scroll(&quot;SOMETHING HAPPENED!&quot;);
}

int main()
{
    uBit.init();
    uBit.messageBus.listen(MICROBIT_ID_ANY, MICROBIT_EVT_ANY, onEvent);

    // We don't want to drop out of main!
    while(1)
        uBit.sleep(100);
}</code></pre>


<h2 id="defining-a-threading-mode">Defining a Threading Mode<a class="headerlink" href="#defining-a-threading-mode" title="Permanent link">#</a></h2>
<p>Whenever you register a listener, you may choose the threading mode used with that handler. Every event handler can have its own threading mode, that defines when your handler
will be executed, and how it will react to receiving multiple events.</p>
<p>There are four permissible modes for event handlers. These are:</p>
<table>
<thead>
<tr>
<th>Threading mode</th>
<th>Brief Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MESSAGE_BUS_LISTENER_IMMEDIATE</td>
<td>Handler is called directly from the code raising the event. Event handler is <em>not</em> permitted to block.</td>
</tr>
<tr>
<td>MESSAGE_BUS_LISTENER_DROP_IF_BUSY</td>
<td>Handler is executed through its own fiber. If another event arrives whilst the previous event is still being processed, the new event will be silently dropped.</td>
</tr>
<tr>
<td>MESSAGE_BUS_LISTENER_QUEUE_IF_BUSY</td>
<td>Handler is executed though its own fiber. If another event arrives, it is queued, and the event handler will immediately be called again once processing is complete. (default)</td>
</tr>
<tr>
<td>MESSAGE_BUS_LISTENER_REENTRANT</td>
<td>Every event is executed in its own fiber. if another event arrives, it is handled concurrently in its own fiber.</td>
</tr>
</tbody>
</table>
<p>These various modes provide great flexibility in how the runtime can be used to support higher level languages and applications. For example, <code>MESSAGE_BUS_LISTENER_IMMEDIATE</code> is ideal for very simple, lightweight handlers, as this will provide very timely response to events with a low processing overhead. However, it is easy to cause side effects on other parts of the code if it does not return promptly.
<code>MESSAGE_BUS_LISTENER_DROP_IF_BUSY</code> provide semantics identical to the Scratch programming language, and can be used to build easy to understand, asynchronous environments.</p>
<p><code>MESSAGE_BUS_LISTENER_QUEUE_IF_BUSY</code> provides similar semantics, but with tolerance to avoiding loss of high frequency events.</p>
<p><code>MESSAGE_BUS_LISTENER_REENTRANT</code> provides guaranteed causal ordering and improved concurrency, but at the cost of additional complexity and RAM.</p>
<p>You can define the threading mode you want to use on a per event handler basis as an optional final parameter to the listen function:</p>
<pre class="code"><code class="language-cpp">#include &quot;MicroBit.h&quot;

MicroBit    uBit;

bool pressed = false;

void onButtonA(MicroBitEvent)
{
    pressed = true;
}

int main()
{
    uBit.init();
    uBit.messageBus.listen(MICROBIT_ID_BUTTON_A, MICROBIT_BUTTON_EVT_CLICK, onButtonA, MESSAGE_BUS_LISTENER_IMMEDIATE);

    // We don't want to drop out of main!
    while(1)
    {
        if(pressed)
            uBit.display.scroll(&quot;Pressed!&quot;);
        uBit.sleep(100);
    }
}</code></pre>


<h2 id="c-event-handlers">C++ Event Handlers<a class="headerlink" href="#c-event-handlers" title="Permanent link">#</a></h2>
<p>It is also possible to write event handlers as C++ member functions. If you don&rsquo;t know what this means, then don&rsquo;t worry, as that also means you won&rsquo;t need it. :-)</p>
<p>For those programmers who do like to write C++, you can use a variation of the <code>listen</code> function to register your member function event handler.</p>
<p>This takes the same form as the examples above, but with an additional parameter to specify the object to call the method on. You are also required to specify your event handler using legal C++ syntax.</p>
<p>For example, you can write code like this to register an event handler in your own class:</p>
<pre class="code"><code class="language-cpp">MyCoolObject::onButtonPressed(MicroBitEvent e)
{
    uBit.display.print(&quot;A&quot;);
}

MyCoolObject::MyCoolObject()
{
    uBit.messageBus.listen(MICROBIT_ID_BUTTON_A, MICROBIT_BUTTON_EVT_CLICK, this, &amp;MyCoolObject::onButtonPressed);
}</code></pre>


<p>Again, it is also possible to a threading mode as an optional final parameter:</p>
<pre class="code"><code class="language-cpp">MyCoolObject::onButtonPressed(MicroBitEvent e)
{
    uBit.display.print(&quot;A&quot;);
}

MyCoolObject::MyCoolObject()
{
    uBit.messageBus.listen(MICROBIT_ID_BUTTON_A, MICROBIT_BUTTON_EVT_CLICK, this, &amp;MyCoolObject::onButtonPressed, MESSAGE_BUS_LISTENER_IMMEDIATE);
}</code></pre>


<h2 id="removing-event-handlers">Removing Event Handlers<a class="headerlink" href="#removing-event-handlers" title="Permanent link">#</a></h2>
<p>Event handlers can be dynamically removed from the message bus as well as added. To do this, use the <code>ignore</code> function. This takes precisely the same parameters as the
listen function, except that the threading mode argument is never used.</p>
<p>For example, to remove the event handlers shown above:</p>
<pre class="code"><code class="language-cpp">uBit.messageBus.ignore(MICROBIT_ID_BUTTON_A, MICROBIT_BUTTON_EVT_CLICK, onButtonA);
uBit.messageBus.ignore(MICROBIT_ID_BUTTON_A, MICROBIT_BUTTON_EVT_CLICK, this, &amp;MyCoolObject::onButtonPressed);</code></pre>


<h2 id="message-bus-id">Message Bus ID<a class="headerlink" href="#message-bus-id" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>MICROBIT_ID_MESSAGE_BUS_LISTENER</td>
<td>1021</td>
</tr>
</tbody>
</table>
<p>The message bus will send a <code>MICROBIT_ID_MESSAGE_BUS_LISTENER</code> event whenever a new listener is added to the message bus.</p>
<p>This event allows other parts of the system to detect when interactions are taking place with a component. This is primarily used as a power management mechanism - allowing on demand activation of hardware when necessary.</p>
<h2 id="message-bus-events">Message Bus Events<a class="headerlink" href="#message-bus-events" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Message Bus ID of listener</td>
<td>1-65535</td>
</tr>
</tbody>
</table>
<h2 id="api">API<a class="headerlink" href="#api" title="Permanent link">#</a></h2>
<h2 id="constructor">Constructor<a class="headerlink" href="#constructor" title="Permanent link">#</a></h2>
<p><br/></p>
<h4 id="microbitmessagebus">MicroBitMessageBus()<a class="headerlink" href="#microbitmessagebus" title="Permanent link">#</a></h4>
<h5 id="description">Description<a class="headerlink" href="#description" title="Permanent link">#</a></h5>
<p>Default constructor.  </p>
<p>Adds itself as a fiber component, and also configures itself to be the default  EventModel  if defaultEventBus is NULL.           </p>
<h2 id="send">send<a class="headerlink" href="#send" title="Permanent link">#</a></h2>
<p><br/></p>
<h4 id="int-send-microbitevent-evt"><div style='color:#a71d5d; display:inline-block'>int</div> <div style='color:#795da3; display:inline-block'>send</div>( <div style='color:#a71d5d; display:inline-block'>MicroBitEvent</div> evt)<a class="headerlink" href="#int-send-microbitevent-evt" title="Permanent link">#</a></h4>
<h5 id="description_1">Description<a class="headerlink" href="#description_1" title="Permanent link">#</a></h5>
<p>Queues the given event to be sent to all registered recipients.  </p>
<h5 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">#</a></h5>
<blockquote>
<p><div style='color:#a71d5d; display:inline-block'>MicroBitEvent</div> evt - The event to send.</p>
</blockquote>
<h5 id="example">Example<a class="headerlink" href="#example" title="Permanent link">#</a></h5>
<pre class="code"><code class="language-cpp"> MicroBitMessageBus bus; 

 // Creates and sends the MicroBitEvent using bus. 
 MicrobitEvent evt(MICROBIT_ID_BUTTON_A, MICROBIT_BUTTON_EVT_CLICK); 

 // Creates the MicrobitEvent, but delays the sending of that event. 
 MicrobitEvent evt1(MICROBIT_ID_BUTTON_A, MICROBIT_BUTTON_EVT_CLICK, CREATE_ONLY); 

 bus.send(evt1); 

 // This has the same effect! 
 evt1.fire() </code></pre>


<h2 id="process">process<a class="headerlink" href="#process" title="Permanent link">#</a></h2>
<p><br/></p>
<h4 id="int-process-microbitevent-evt"><div style='color:#a71d5d; display:inline-block'>int</div> <div style='color:#795da3; display:inline-block'>process</div>( <div style='color:#a71d5d; display:inline-block'>MicroBitEvent  &amp;</div> evt)<a class="headerlink" href="#int-process-microbitevent-evt" title="Permanent link">#</a></h4>
<h5 id="description_2">Description<a class="headerlink" href="#description_2" title="Permanent link">#</a></h5>
<p>Internal function, used to deliver the given event to all relevant recipients. Normally, this is called once an event has been removed from the event queue.  </p>
<h5 id="parameters_1">Parameters<a class="headerlink" href="#parameters_1" title="Permanent link">#</a></h5>
<blockquote>
<p><div style='color:#a71d5d; display:inline-block'>MicroBitEvent  &amp;</div> evt - The event to send.</p>
</blockquote>
<h5 id="returns">Returns<a class="headerlink" href="#returns" title="Permanent link">#</a></h5>
<p>1 if all matching listeners were processed, 0 if further processing is required.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is recommended that all external code uses the  send()  function instead of this function, or the constructors provided by MicrobitEvent. </p>
</div>
<p><br/></p>
<h4 id="int-process-microbitevent-evt-bool-urgent"><div style='color:#a71d5d; display:inline-block'>int</div> <div style='color:#795da3; display:inline-block'>process</div>( <div style='color:#a71d5d; display:inline-block'>MicroBitEvent  &amp;</div> evt,  <div style='color:#a71d5d; display:inline-block'>bool</div> urgent)<a class="headerlink" href="#int-process-microbitevent-evt-bool-urgent" title="Permanent link">#</a></h4>
<h5 id="description_3">Description<a class="headerlink" href="#description_3" title="Permanent link">#</a></h5>
<p>Internal function, used to deliver the given event to all relevant recipients. Normally, this is called once an event has been removed from the event queue.  </p>
<h5 id="parameters_2">Parameters<a class="headerlink" href="#parameters_2" title="Permanent link">#</a></h5>
<blockquote>
<p><div style='color:#a71d5d; display:inline-block'>MicroBitEvent  &amp;</div> evt - The event to send.</p>
<p><div style='color:#a71d5d; display:inline-block'>bool</div> urgent - The type of listeners to process (optional). If set to true, only listeners defined as urgent and non-blocking will be processed otherwise, all other (standard) listeners will be processed. Defaults to false.</p>
</blockquote>
<h5 id="returns_1">Returns<a class="headerlink" href="#returns_1" title="Permanent link">#</a></h5>
<p>1 if all matching listeners were processed, 0 if further processing is required.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is recommended that all external code uses the  send()  function instead of this function, or the constructors provided by MicrobitEvent. </p>
</div>
<h2 id="elementat">elementAt<a class="headerlink" href="#elementat" title="Permanent link">#</a></h2>
<p><br/></p>
<h4 id="microbitlistener-elementat-int-n"><div style='color:#a71d5d; display:inline-block'>MicroBitListener</div> <div style='color:#795da3; display:inline-block'>elementAt</div>( <div style='color:#a71d5d; display:inline-block'>int</div> n)<a class="headerlink" href="#microbitlistener-elementat-int-n" title="Permanent link">#</a></h4>
<h5 id="description_4">Description<a class="headerlink" href="#description_4" title="Permanent link">#</a></h5>
<p>Returns the microBitListener with the given position in our list.  </p>
<h5 id="parameters_3">Parameters<a class="headerlink" href="#parameters_3" title="Permanent link">#</a></h5>
<blockquote>
<p><div style='color:#a71d5d; display:inline-block'>int</div> n - The position in the list to return.</p>
</blockquote>
<h5 id="returns_2">Returns<a class="headerlink" href="#returns_2" title="Permanent link">#</a></h5>
<p>the  MicroBitListener  at postion n in the list, or NULL if the position is invalid. </p>
<h2 id="add">add<a class="headerlink" href="#add" title="Permanent link">#</a></h2>
<p><br/></p>
<h4 id="int-add-microbitlistener-42-newlistener"><div style='color:#a71d5d; display:inline-block'>int</div> <div style='color:#795da3; display:inline-block'>add</div>( <div style='color:#a71d5d; display:inline-block'>MicroBitListener  *</div> newListener)<a class="headerlink" href="#int-add-microbitlistener-42-newlistener" title="Permanent link">#</a></h4>
<h5 id="description_5">Description<a class="headerlink" href="#description_5" title="Permanent link">#</a></h5>
<p>Add the given  MicroBitListener  to the list of event handlers, unconditionally.  </p>
<h5 id="parameters_4">Parameters<a class="headerlink" href="#parameters_4" title="Permanent link">#</a></h5>
<blockquote>
<p><div style='color:#a71d5d; display:inline-block'>MicroBitListener  *</div> newListener</p>
</blockquote>
<h5 id="returns_3">Returns<a class="headerlink" href="#returns_3" title="Permanent link">#</a></h5>
<p>MICROBIT_OK if the listener is valid, MICROBIT_INVALID_PARAMETER otherwise. </p>
<h2 id="remove">remove<a class="headerlink" href="#remove" title="Permanent link">#</a></h2>
<p><br/></p>
<h4 id="int-remove-microbitlistener-42-newlistener"><div style='color:#a71d5d; display:inline-block'>int</div> <div style='color:#795da3; display:inline-block'>remove</div>( <div style='color:#a71d5d; display:inline-block'>MicroBitListener  *</div> newListener)<a class="headerlink" href="#int-remove-microbitlistener-42-newlistener" title="Permanent link">#</a></h4>
<h5 id="description_6">Description<a class="headerlink" href="#description_6" title="Permanent link">#</a></h5>
<p>Remove the given  MicroBitListener  from the list of event handlers.  </p>
<h5 id="parameters_5">Parameters<a class="headerlink" href="#parameters_5" title="Permanent link">#</a></h5>
<blockquote>
<p><div style='color:#a71d5d; display:inline-block'>MicroBitListener  *</div> newListener</p>
</blockquote>
<h5 id="returns_4">Returns<a class="headerlink" href="#returns_4" title="Permanent link">#</a></h5>
<p>MICROBIT_OK if the listener is valid, MICROBIT_INVALID_PARAMETER otherwise. </p>
<hr />
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../button/" class="btn btn-neutral float-right" title="buttons">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../serial/" class="btn btn-neutral" title="serial"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2016 <a href="https://microbit.vn">Microbit Việt Nam</a></p>
    
  </div>

  
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<!-- <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/microbitvn/help.microbit.vn" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../serial/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../button/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div> -->

<script type="text/javascript">
  // If cookie is defined toggle the id
  if (typeof $.cookie('docToggle') !== 'undefined') {
      // Parse cookie which is an array
      var _parsed_cookie = JSON.parse($.cookie('docToggle'));
      // Loop over array and show hidden divs
      $.each(_parsed_cookie, function(index, value) {
          // Toggle
          $("[id='hidden_" + value + "']").css('display','');
      })
  }
</script>

</body>
</html>